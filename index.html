<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>YouTube & Twitch Clicker</title>
  <style>
    :root {
      --main-bg: #18181b;
      --card-bg: #23232b;
      --accent: #ff001a;
      --accent2: #9147ff;
      --shadow: rgba(0,0,0,0.3);
      --text: #f8fafc;
      --btn: #27272a;
      --btn-hover: #3f3f46;
      --border: #333;
      --radius: 1.2em;
    }
    html, body {
      margin:0; padding:0; min-height:100vh;
      background: var(--main-bg); color:var(--text); font-family:sans-serif;
      overflow-x:hidden;
    }
    .container {
      max-width:430px; margin:0 auto; min-height:100vh;
      padding:1em; display:flex; flex-direction:column; align-items:center;
    }
    .card {
      background:var(--card-bg); border-radius:var(--radius); box-shadow:0 2px 8px var(--shadow);
      margin:1em 0; padding:1.5em; width:100%; max-width:380px; text-align:center;
    }
    h1, h2, h3 {margin:.4em 0;}
    input, button, select {
      font-size:1.1em; border-radius:.7em; border:1px solid var(--border);
      padding:.5em 1.2em; margin:.3em 0; background:var(--btn); color:var(--text);
      transition:.2s; outline:none;
    }
    input[type="file"] {padding:.3em;}
    button {
      min-width:120px; font-weight:bold; box-shadow:0 2px 6px var(--shadow);
      display:inline-flex; align-items:center; justify-content:center;
      cursor:pointer; border:none;
    }
    button:active {transform:scale(0.97);}
    button:hover, .menu-btn.selected {background:var(--btn-hover);}
    .main-btn {
      width:140px;height:140px; border-radius:50%; font-size:2.2em;
      margin:1.2em auto; display:flex; flex-direction:column; align-items:center; justify-content:center;
      border:4px solid var(--accent); background:var(--accent); color:#fff; font-weight:bolder; box-shadow:0 0 16px var(--accent);
      position:relative;
      overflow:visible;
    }
    .main-btn.twitch {
      border-color: var(--accent2); background: var(--accent2); box-shadow:0 0 16px var(--accent2);
    }
    .main-btn img {
      width:80px; height:80px; border-radius:50%; margin-bottom:.1em; object-fit:cover; border:3px solid #fff;
      box-shadow:0 0 6px #0009;
      display:block;
    }
    .menu-bar {
      display:flex; gap:.6em; justify-content:center; margin:0 0 1em 0;
    }
    .menu-btn {
      border-radius:.8em; padding:.5em 1.2em; background:var(--btn); color:var(--text);
      font-weight:bold; border:none; cursor:pointer; min-width:80px;
    }
    .hidden {display:none!important;}
    .shop-item {
      background:var(--main-bg); border-radius:.8em; margin:.7em 0; padding:.8em 1em; box-shadow:0 1px 4px var(--shadow);
      display:flex; justify-content:space-between; align-items:center; gap:.3em;
      font-size:1em;
    }
    .shop-label {font-weight:bold;}
    .shop-upgrade {background:var(--btn-hover);}
    .shop-cost {color:#fff2; margin-right:.5em;}
    .progress-bar {
      height:1.2em; background:var(--btn-hover); border-radius:1em; margin:.5em 0;
      position:relative; overflow:hidden;
    }
    .progress-bar-inner {
      height:100%; background:var(--accent); border-radius:1em; width:0%; transition:.3s;
    }
    .progress-bar.twitch .progress-bar-inner {
      background:var(--accent2);
    }
    .videos-list {
      text-align:left; max-height:180px; overflow:auto; font-size:.98em;
      background:var(--btn); border-radius:.6em; padding:.7em 1em; margin:.8em auto;
    }
    .videos-list li {margin:.2em 0;}
    .profile-pic-big {
      width:110px; height:110px; border-radius:50%; object-fit:cover; border:5px solid var(--accent);
      margin:0 auto 1em auto; display:block; box-shadow:0 4px 16px var(--accent);
    }
    .profile-pic-small {width:32px; height:32px; border-radius:50%; object-fit:cover; margin-right:.4em;}
    .input-label {font-size:.97em; margin-top:.7em; color:#bbb;}
    .code-box {
      background:var(--btn-hover); padding:.6em 1.2em; border-radius:.8em; font-size:1.1em; margin:.6em auto .6em auto;
      letter-spacing:.07em; font-family:monospace; user-select:all;
    }
    @media (max-width:520px){
      .container{max-width:98vw;}
      .card{max-width:99vw;}
      .main-btn{width:110px;height:110px;}
      .profile-pic-big{width:80px;height:80px;}
    }
  </style>
</head>
<body>
<div class="container">

  <!-- Menüleiste -->
  <div class="menu-bar">
    <button class="menu-btn selected" id="menu-btn-main">Home</button>
    <button class="menu-btn" id="menu-btn-cut" >Cut</button>
    <button class="menu-btn" id="menu-btn-videos">Videos</button>
    <button class="menu-btn" id="menu-btn-shop">Shop</button>
    <button class="menu-btn" id="menu-btn-profile">Profil</button>
    <button class="menu-btn hidden" id="menu-btn-twitch">Twitch</button>
  </div>

  <!-- Home/Main -->
  <div class="card" id="main-menu">
    <h2><span id="main-channelname"></span></h2>
    <button class="main-btn" id="yt-btn">
      <img id="main-profile-pic" src="" alt="Profilbild"/>
      <span><span id="clips-count"></span><br>Clips</span>
    </button>
    <div style="margin-top:1em;">
      <span style="font-size:1.2em;">Abonnenten: <b id="subs-count"></b></span>
    </div>
    <div class="progress-bar" id="main-progress-bar"><div class="progress-bar-inner" id="main-progress"></div></div>
    <button id="go-cut-btn">Video schneiden ✂️</button>
    <button class="hidden" id="go-twitch-btn">Zum Twitch-Menü</button>
    <ul style="margin-top:1em; text-align:left;">
      <li>Clips: Durch Klicks sammeln</li>
      <li>Genug Clips? Gehe zum Cut-Menü für Videos</li>
      <li>Videos generieren Abonnenten</li>
      <li>Im Shop kannst du upgraden & Helfer kaufen!</li>
    </ul>
  </div>

  <!-- Cut/Video erstellen -->
  <div class="card hidden" id="cut-menu">
    <h2>Video schneiden</h2>
    <div>
      <span>Clips: <b id="clips-cut"></b> / <b id="clips-needed"></b></span>
      <div class="progress-bar"><div class="progress-bar-inner" id="cut-progress"></div></div>
      <button id="start-cut-btn">Schneiden starten</button>
      <div id="cutting-block" class="hidden">
        <br>
        <b>Schneide Video...</b>
        <div class="progress-bar"><div class="progress-bar-inner" id="cutting-bar"></div></div>
      </div>
      <div id="upload-block" class="hidden">
        <input id="video-title" placeholder="Titel für Video">
        <button id="upload-btn">Hochladen</button>
      </div>
    </div>
    <button id="back-main1">Zurück</button>
  </div>

  <!-- Videos -->
  <div class="card hidden" id="videos-menu">
    <h2>Alle Videos</h2>
    <ul class="videos-list" id="videos-list"></ul>
    <button id="back-main2">Zurück</button>
  </div>

  <!-- Shop -->
  <div class="card hidden" id="shop-menu">
    <h2>Shop</h2>
    <div id="shop-items"></div>
    <button id="back-main3">Zurück</button>
  </div>

  <!-- Twitch Menü -->
  <div class="card hidden" id="twitch-menu">
    <h2>Twitch</h2>
    <button class="main-btn twitch" id="twitch-btn">
      <img id="twitch-profile-pic" src="" alt="Profilbild"/>
      <span><span id="twitch-clips-count"></span><br>Clips</span>
    </button>
    <div>
      <span style="font-size:1.2em;">Twitch Abos: <b id="twitch-subs-count"></b></span>
    </div>
    <div class="progress-bar twitch" id="twitch-progress-bar"><div class="progress-bar-inner" id="twitch-progress"></div></div>
    <button id="go-twitch-cut-btn">Stream schneiden ✂️</button>
    <button id="back-main4">Zurück</button>
  </div>

  <!-- Profil -->
  <div class="card hidden" id="profile-menu">
    <h2>Profil</h2>
    <img class="profile-pic-big" id="profile-pic-big" src="" alt="Profilbild"/>
    <div><b>YouTube:</b> <span id="profile-channelname"></span></div>
    <div><b>Twitch:</b> <span id="profile-twitchname"></span></div>
    <div class="input-label">YouTube Kanalname:</div>
    <input id="edit-channelname" maxlength="18" placeholder="Kanalname">
    <div class="input-label">YouTube Profilbild:</div>
    <input type="file" id="edit-profile-pic" accept="image/*">
    <div class="input-label">Twitch Kanalname:</div>
    <input id="edit-twitchname" maxlength="18" placeholder="Twitch Name">
    <div class="input-label">Twitch Profilbild:</div>
    <input type="file" id="edit-twitch-pic" accept="image/*">
    <div class="input-label">Account-Code:</div>
    <div class="code-box" id="account-code"></div>
    <div class="input-label">Account laden (Code eingeben):</div>
    <input id="import-code" maxlength="8" placeholder="Code">
    <button id="import-btn">Account laden</button>
    <button id="back-main5">Zurück</button>
  </div>

</div>
<script>
// ---- Datenstruktur und State ---- //
const defaultState = {
  channelName: "MeinChannel",
  profilePic: '', // base64
  twitchName: "MeinTwitch",
  twitchPic: '',
  code: '', // 8 Zeichen
  clips: 0,
  subs: 0,
  twitchClips: 0,
  twitchSubs: 0,
  cutProgress: 0,
  twitchProgress: 0,
  videos: [],
  twitchVideos: [],
  playButtons: 0,
  shop: {
    cutter: {level:0, cost:60},
    clicker: {level:0, cost:40},
    streamer: {level:0, cost:100},
    manager: {level:0, cost:250}
  }
};
let state = {};
const YT_CLIPS_PER_VIDEO = 20;
const TW_CLIPS_PER_VIDEO = 25;
const VIDEO_BASE_SUBS = 22; // Grund-Abos pro Video
const TWITCH_UNLOCK_SUBS = 250;
const PLAY_BUTTONS = [
  {subs:100, name:"Silber"},
  {subs:1000, name:"Gold"},
  {subs:10000, name:"Diamant"},
  {subs:100000, name:"Rubin"},
  {subs:1000000, name:"Edelstein"}
];
let playBoost = 1;
let twitchUnlocked = false;
let intervalIds = [];
// ---- LocalStorage ---- //
function saveState(){
  localStorage.setItem("ytclicker-state", JSON.stringify(state));
}
function loadState(){
  let s = localStorage.getItem("ytclicker-state");
  if(s) state = JSON.parse(s);
  else state = {...defaultState, code: randomCode()};
}
function setState(s){
  state = s;
  saveState(); updateUI();
}
function resetAll(){
  localStorage.removeItem("ytclicker-state");
  location.reload();
}
function randomCode(){
  return Math.random().toString(36).substr(2,8).toUpperCase();
}

// ---- Menü-Wechsel ---- //
const menus = {
  main: document.getElementById("main-menu"),
  cut: document.getElementById("cut-menu"),
  videos: document.getElementById("videos-menu"),
  shop: document.getElementById("shop-menu"),
  profile: document.getElementById("profile-menu"),
  twitch: document.getElementById("twitch-menu")
};
function showMenu(m){
  for(let k in menus) menus[k].classList.add("hidden");
  menus[m].classList.remove("hidden");
  // Menubuttons
  document.querySelectorAll(".menu-btn").forEach(btn=>btn.classList.remove("selected"));
  if(m==="main") menuBtnMain.classList.add("selected");
  if(m==="cut") menuBtnCut.classList.add("selected");
  if(m==="videos") menuBtnVideos.classList.add("selected");
  if(m==="shop") menuBtnShop.classList.add("selected");
  if(m==="profile") menuBtnProfile.classList.add("selected");
  if(m==="twitch") menuBtnTwitch.classList.add("selected");
  if(m==="twitch") updateTwitchMenu();
  if(m==="videos") updateVideosList();
  if(m==="profile") updateProfileMenu();
}
const menuBtnMain = document.getElementById("menu-btn-main");
const menuBtnCut = document.getElementById("menu-btn-cut");
const menuBtnVideos = document.getElementById("menu-btn-videos");
const menuBtnShop = document.getElementById("menu-btn-shop");
const menuBtnProfile = document.getElementById("menu-btn-profile");
const menuBtnTwitch = document.getElementById("menu-btn-twitch");
menuBtnMain.onclick=()=>showMenu("main");
menuBtnCut.onclick=()=>showMenu("cut");
menuBtnVideos.onclick=()=>showMenu("videos");
menuBtnShop.onclick=()=>showMenu("shop");
menuBtnProfile.onclick=()=>showMenu("profile");
menuBtnTwitch.onclick=()=>showMenu("twitch");

// ---- UI-Update ---- //
function updateUI(){
  // Main
  document.getElementById("main-channelname").textContent = state.channelName;
  document.getElementById("clips-count").textContent = state.clips;
  document.getElementById("subs-count").textContent = state.subs;
  document.getElementById("main-profile-pic").src = state.profilePic || "https://i.imgur.com/6VBx3io.png";
  // Cut
  document.getElementById("clips-cut").textContent = state.clips;
  document.getElementById("clips-needed").textContent = YT_CLIPS_PER_VIDEO;
  // Shop
  updateShop();
  // Twitch unlock
  twitchUnlocked = state.subs >= TWITCH_UNLOCK_SUBS;
  menuBtnTwitch.classList.toggle("hidden",!twitchUnlocked);
  document.getElementById("go-twitch-btn").classList.toggle("hidden",!twitchUnlocked);
  // Play Buttons
  let playBtns = PLAY_BUTTONS.filter(pb=>state.subs>=pb.subs).length;
  if(playBtns>state.playButtons){
    playBoost = 1+0.3*playBtns;
    state.playButtons = playBtns;
    saveState();
  }
  // Progress
  let prog = Math.min(state.clips/YT_CLIPS_PER_VIDEO,1)*100;
  document.getElementById("main-progress").style.width = prog+"%";
}
updateUI();

// ---- Clips Click ---- //
document.getElementById("yt-btn").onclick = ()=>{
  state.clips++;
  saveState(); updateUI();
};

// ---- Go Cut ---- //
document.getElementById("go-cut-btn").onclick=()=>showMenu("cut");

// ---- Cut Menü ---- //
let cutting=false;
document.getElementById("start-cut-btn").onclick= function(){
  if(state.clips<YT_CLIPS_PER_VIDEO||cutting)return;
  cutting=true;
  this.disabled=true;
  document.getElementById("cutting-block").classList.remove("hidden");
  let cutTime = Math.max(3000-(state.shop.cutter.level*400*playBoost),900); // min 900ms
  let start = Date.now();
  function tick(){
    let p = Math.min(1, (Date.now()-start)/cutTime);
    document.getElementById("cutting-bar").style.width=(p*100)+"%";
    if(p<1) setTimeout(tick,20);
    else{
      document.getElementById("cutting-block").classList.add("hidden");
      document.getElementById("upload-block").classList.remove("hidden");
      document.getElementById("upload-btn").onclick = function(){
        let vt = document.getElementById("video-title").value.trim();
        if(!vt)vt="Mein Video "+(state.videos.length+1);
        state.clips -= YT_CLIPS_PER_VIDEO;
        let abos = Math.floor(VIDEO_BASE_SUBS*(1+(state.videos.length/6))*playBoost*(1-Math.random()/4))+1;
        // Lose random Abos
        if(state.videos.length>2 && Math.random()<0.15) abos-=Math.floor(abos/2);
        state.subs = Math.max(0,state.subs+abos);
        state.videos.unshift({title:vt,subs:abos,ts:Date.now()});
        saveState(); updateUI();
        // Reset
        document.getElementById("upload-block").classList.add("hidden");
        document.getElementById("cutting-bar").style.width="0%";
        document.getElementById("video-title").value="";
        cutting=false;document.getElementById("start-cut-btn").disabled=false;
        showMenu("videos");
      }
    }
  } tick();
};

// ---- Videos Menü ---- //
function updateVideosList(){
  const ul = document.getElementById("videos-list");
  ul.innerHTML = '';
  if(state.videos.length===0)ul.innerHTML="<li>Noch keine Videos.</li>";
  state.videos.forEach(v=>{
    let d=new Date(v.ts); ul.innerHTML += `<li>🎬 <b>${v.title}</b> | +${v.subs} Abos <span style="color:#999;font-size:.87em;">(${d.toLocaleDateString()} ${d.toLocaleTimeString().substr(0,5)})</span></li>`;
  });
}

// ---- Shop ---- //
const SHOPDATA = [
  {id:"cutter",label:"Cutter",desc:"Schneidet Videos automatisch",icon:"✂️"},
  {id:"clicker",label:"Klicker",desc:"Klickt automatisch für Clips",icon:"🖱️"},
  {id:"streamer",label:"Streamer",desc:"Klickt Twitch automatisch",icon:"🎮"},
  {id:"manager",label:"Manager",desc:"+5% Speed für alles",icon:"👔"}
];
function updateShop(){
  let list = '';
  SHOPDATA.forEach(item=>{
    let s=state.shop[item.id],nextCost=Math.floor(s.cost*(1.12+0.05*s.level));
    list+=`
      <div class="shop-item">
        <span class="shop-label">${item.icon} ${item.label} <br><span style="font-size:.93em;color:#aaa">${item.desc}</span></span>
        <span>Lvl. <b>${s.level}</b></span>
        <span class="shop-cost">${s.cost} Clips</span>
        <button class="shop-upgrade" id="buy-${item.id}">Kaufen</button>
      </div>
    `;
  });
  document.getElementById("shop-items").innerHTML = list;
  // Setze Events
  SHOPDATA.forEach(item=>{
    document.getElementById("buy-"+item.id).onclick=()=>{
      let s=state.shop[item.id];
      if(state.clips>=s.cost){
        state.clips-=s.cost;
        s.level++;
        // Preis exponential
        s.cost = Math.floor(s.cost*1.29+12*s.level*playBoost);
        // Manager-Upgrade Effekt
        if(item.id==="manager"){
          // +5% Speed
          playBoost = 1+0.3*state.playButtons+0.05*s.level;
        }
        saveState(); updateUI();
      }
    }
  });
}

// ---- Shop Auto-Aktionen ---- //
function startIntervals(){
  intervalIds.forEach(id=>clearInterval(id));
  intervalIds=[];
  // Klicker: produziert Clips
  if(state.shop.clicker.level>0){
    intervalIds.push(setInterval(()=>{
      let val = Math.floor(1+state.shop.clicker.level*playBoost);
      state.clips+=val;
      saveState(); updateUI();
    }, 1000));
  }
  // Cutter: schneidet automatisch Videos
  if(state.shop.cutter.level>0){
    intervalIds.push(setInterval(()=>{
      if(state.clips>=YT_CLIPS_PER_VIDEO){
        let cutTime = Math.max(4000-(state.shop.cutter.level*800*playBoost),700);
        setTimeout(()=>{
          if(state.clips>=YT_CLIPS_PER_VIDEO){
            state.clips-=YT_CLIPS_PER_VIDEO;
            let abos = Math.floor(VIDEO_BASE_SUBS*(1+(state.videos.length/7))*playBoost*(1-Math.random()/4))+1;
            state.subs = Math.max(0,state.subs+abos);
            state.videos.unshift({title:"Auto-Video "+(state.videos.length+1),subs:abos,ts:Date.now()});
            saveState(); updateUI();
          }
        },cutTime);
      }
    }, 6000));
  }
  // Streamer: Twitch-Clips auto
  if(state.shop.streamer.level>0 && twitchUnlocked){
    intervalIds.push(setInterval(()=>{
      let val = Math.floor(1+state.shop.streamer.level*playBoost);
      state.twitchClips+=val;
      saveState(); updateTwitchMenu();
    }, 1100));
  }
}
setInterval(startIntervals, 3000); // Hält Upgrades/Intervalls synchron

// ---- Twitch Menü ---- //
function updateTwitchMenu(){
  document.getElementById("twitch-clips-count").textContent = state.twitchClips;
  document.getElementById("twitch-subs-count").textContent = state.twitchSubs;
  document.getElementById("twitch-profile-pic").src = state.twitchPic||"https://i.imgur.com/6VBx3io.png";
  let prog = Math.min(state.twitchClips/TW_CLIPS_PER_VIDEO,1)*100;
  document.getElementById("twitch-progress").style.width = prog+"%";
}
document.getElementById("twitch-btn").onclick = ()=>{
  state.twitchClips++;
  saveState(); updateTwitchMenu();
};
document.getElementById("go-twitch-btn").onclick=()=>showMenu("twitch");
document.getElementById("go-twitch-cut-btn").onclick= function(){
  if(state.twitchClips<TW_CLIPS_PER_VIDEO)return alert("Du brauchst mehr Twitch-Clips!");
  // Twitch "schneiden"
  let cutTime = Math.max(3500-(state.shop.streamer.level*450*playBoost),950);
  let start = Date.now();
  document.getElementById("go-twitch-cut-btn").disabled=true;
  function tick(){
    let p = Math.min(1, (Date.now()-start)/cutTime);
    document.getElementById("twitch-progress").style.width=(p*100)+"%";
    if(p<1) setTimeout(tick,22);
    else{
      document.getElementById("go-twitch-cut-btn").disabled=false;
      state.twitchClips -= TW_CLIPS_PER_VIDEO;
      let abos = Math.floor(19*(1+state.twitchVideos.length/5)*playBoost*(1-Math.random()/5))+1;
      state.twitchSubs = Math.max(0,state.twitchSubs+abos);
      state.twitchVideos.unshift({title:"Twitch-Stream "+(state.twitchVideos.length+1),subs:abos,ts:Date.now()});
      saveState(); updateTwitchMenu();
      alert("Twitch-Stream hochgeladen! +" + abos + " Twitch-Subs");
    }
  } tick();
};

// ---- Play-Buttons ---- //
// Play-Buttons werden automatisch als Boost aktiviert, UI siehe updateUI()

// ---- Profil Menü ---- //
function updateProfileMenu(){
  document.getElementById("profile-pic-big").src = state.profilePic||"https://i.imgur.com/6VBx3io.png";
  document.getElementById("profile-channelname").textContent = state.channelName;
  document.getElementById("profile-twitchname").textContent = state.twitchName;
  document.getElementById("edit-channelname").value = state.channelName;
  document.getElementById("edit-twitchname").value = state.twitchName;
  document.getElementById("account-code").textContent = state.code;
}
document.getElementById("edit-channelname").oninput = function(){
  state.channelName=this.value.substr(0,18);
  saveState(); updateUI();
};
document.getElementById("edit-twitchname").oninput = function(){
  state.twitchName=this.value.substr(0,18);
  saveState(); updateProfileMenu();
};
// Profilbild-Import
function fileToBase64(file,cb){
  const r = new FileReader();
  r.onload = ()=>cb(r.result);
  r.readAsDataURL(file);
}
document.getElementById("edit-profile-pic").onchange = function(e){
  let f = e.target.files[0]; if(!f)return;
  fileToBase64(f,base64=>{
    state.profilePic=base64; saveState(); updateUI(); updateProfileMenu();
  });
};
document.getElementById("edit-twitch-pic").onchange = function(e){
  let f = e.target.files[0]; if(!f)return;
  fileToBase64(f,base64=>{
    state.twitchPic=base64; saveState(); updateTwitchMenu(); updateProfileMenu();
  });
};
// Account-Code Import/Export
document.getElementById("import-btn").onclick = function(){
  let code = document.getElementById("import-code").value.trim().toUpperCase();
  if(!code)return;
  let data = localStorage.getItem("ytclicker-"+code);
  if(!data) return alert("Kein Account mit Code gefunden!");
  setState(JSON.parse(data));
  updateUI(); updateProfileMenu();
  alert("Account geladen!");
};
function saveAccountCode(){
  localStorage.setItem("ytclicker-"+state.code, JSON.stringify(state));
}
setInterval(saveAccountCode, 3000); // alle 3s

// ---- Back Buttons ---- //
document.getElementById("back-main1").onclick=()=>showMenu("main");
document.getElementById("back-main2").onclick=()=>showMenu("main");
document.getElementById("back-main3").onclick=()=>showMenu("main");
document.getElementById("back-main4").onclick=()=>showMenu("main");
document.getElementById("back-main5").onclick=()=>showMenu("main");

// ---- Erstinitialisierung ---- //
loadState(); updateUI(); updateProfileMenu(); startIntervals();

</script>
</body>
</html>
