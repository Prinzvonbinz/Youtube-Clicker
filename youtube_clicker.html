<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Youtube Clicker</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <style>
    :root { --red:#ff3d3d; --yt:#f00; --tw:#6441a5; --bg:#181818; --gray:#242424; --white:#fff; --b:#000; --g:#22d; }
    html,body{margin:0;padding:0;min-height:100%;background:var(--bg);color:var(--white);font-family:sans-serif;}
    #app{max-width:480px;margin:0 auto;padding:0 8px;}
    .c{text-align:center;}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      font-size:2rem;min-width:120px;min-height:120px;
      border-radius:100px;background:var(--yt);color:#fff;
      border:none;box-shadow:0 3px 8px #0005;cursor:pointer;
      margin:16px 0;transition:.15s;font-weight:bold;
      outline:none;user-select:none;
    }
    .btn:active{background:#b00;}
    .twbtn{background:var(--tw);}
    .profilepic{width:80px;height:80px;border-radius:50%;object-fit:cover;border:3px solid var(--white);}
    #menu{display:flex;justify-content:space-between;margin:16px 0;}
    .menu-btn{color:var(--white);background:var(--gray);border:none;outline:none;font-size:1.2rem;padding:8px 16px;border-radius:8px;margin:0 2px;cursor:pointer;min-width:80px;}
    .menu-btn.active{background:var(--yt);}
    .sec{background:var(--gray);border-radius:16px;padding:16px 8px;margin-bottom:20px;}
    .shop-upg{display:flex;align-items:center;justify-content:space-between;margin:10px 0;}
    .shop-btn{padding:8px 18px;font-size:1rem;border-radius:12px;background:var(--g);color:#fff;border:none;cursor:pointer;}
    .shop-btn:active{background:#118;}
    .shop-upg span{flex:1}
    .inp{display:block;width:100%;margin:8px 0 16px;padding:10px;font-size:1.1rem;border-radius:8px;border:1px solid #333;background:var(--bg);color:var(--white);}
    #clips,#subs,#vids,#tclips,#tvids,#tabs,#playbtns{font-weight:bold;}
    .cut-btn,.upload-btn,.twbtn{margin-top:10px;}
    .video-list{max-height:160px;overflow:auto;margin:10px 0;}
    .video-item{background:#222;padding:8px 6px;margin:4px 0;border-radius:8px;}
    .playbtn{display:inline-block;background:gold;color:#222;border-radius:50px;padding:6px 14px;font-weight:bold;margin:6px;}
    @media (max-width:600px){
      .btn{font-size:1.4rem;min-width:90px;min-height:90px;}
      #app{padding:0;}
    }
    label[for]{cursor:pointer;}
  </style>
</head>
<body>
<div id="app"></div>
<script>
const LS_KEY = "ytclicker_save";
const PLAYBTN_REQS = [1000,10000,100000,1000000,10000000];
function uniqCode(){return Math.random().toString(36).substr(2,8)+Date.now().toString(36);}
function expCost(base,level){return Math.floor(base*Math.pow(1.6,level));}
function loadSave(){
  try{return JSON.parse(localStorage.getItem(LS_KEY))||null;}catch{return null;}
}
function saveGame(obj){
  localStorage.setItem(LS_KEY,JSON.stringify(obj));
}
function imgToData(file,cb){
  const r=new FileReader();
  r.onload=e=>cb(r.result);
  r.readAsDataURL(file);
}
function genProfile(onload,def){
  let s=loadSave()||def||{};
  s.code=s.code||uniqCode();
  s.ytName=s.ytName||'Mein Kanal';
  s.ytPic=s.ytPic||'https://i.imgur.com/sQyQG0C.png';
  s.twName=s.twName||'Mein Twitch';
  s.twPic=s.twPic||'https://static-cdn.jtvnw.net/jtv_user_pictures/xarth/404_user_70x70.png';
  return s;
}
function mainMenu(s,cb){
  let menu = `
    <div class="c sec">
      <img src="${s.ytPic}" class="profilepic" id="ytpic" alt="Profil">
      <div><b>${s.ytName}</b></div>
      <div>Clips: <span id="clips">${s.clips}</span></div>
      <div>Abos: <span id="subs">${s.subs}</span></div>
      <div>Videos: <span id="vids">${s.videos.length}</span></div>
      <button class="btn" id="ytbtn"><img src="${s.ytPic}" class="profilepic" style="width:60px;height:60px;margin-right:10px;">Youtube</button>
      <div>
        <button class="menu-btn" id="goto_cut">Cut</button>
        <button class="menu-btn" id="goto_shop">Shop</button>
        <button class="menu-btn" id="goto_profile">Profil</button>
        ${s.subs>=2000?`<button class="menu-btn" id="goto_twitch">Twitch</button>`:""}
      </div>
      <div id="playbtns"></div>
    </div>`;
  return menu;
}
function cutMenu(s){
  return `
  <div class="c sec">
    <div>Clips: <span id="clips">${s.clips}</span></div>
    <div>Videos: <span id="vids">${s.videos.length}</span></div>
    <input class="inp" id="cut_num" type="number" min="1" max="${s.clips}" value="1">
    <button class="btn cut-btn" id="cut_start">Clips schneiden</button>
    <div id="cutprog"></div>
    <div id="cutresult"></div>
    <button class="menu-btn" id="back_main">Zurück</button>
  </div>
  `;
}
function uploadMenu(s,clips){
  return `
  <div class="c sec">
    <div>Clips zu Video verarbeitet!</div>
    <input class="inp" id="vid_name" maxlength="24" placeholder="Videoname">
    <button class="btn upload-btn" id="upload_vid">Video hochladen</button>
    <div id="uploadprog"></div>
  </div>
  `;
}
function shopMenu(s){
  const upgs = [
    {k:'cutter',n:'Cutter',desc:'Schneidet Videos automatisch.',b:200},
    {k:'klicker',n:'Klicker',desc:'Klickt automatisch.',b:150},
    {k:'streamer',n:'Streamer',desc:'Twitch-Clicks.',b:450},
    {k:'manager',n:'Manager',desc:'Boost für alle (+5%/Upgrade).',b:800}
  ];
  let html = `<div class="c sec"><div><b>Shop</b></div>`;
  upgs.forEach(up=>{
    let level = s[up.k+'Lvl']||0;
    html+=`
      <div class="shop-upg">
        <span>${up.n} (${level})<br><small>${up.desc}</small></span>
        <button class="shop-btn" id="buy_${up.k}">Kaufen<br>${expCost(up.b,level)} Clips</button>
      </div>
    `;
  });
  html+=`<button class="menu-btn" id="back_main">Zurück</button></div>`;
  return html;
}
function profileMenu(s){
  return `
    <div class="c sec">
      <div><b>Profil</b></div>
      <img src="${s.ytPic}" class="profilepic"><br>
      <input class="inp" id="yt_name" value="${s.ytName}" maxlength="18" placeholder="Youtube Name"><br>
      <label class="menu-btn" for="yt_pic_inp">Youtube Bild ändern</label>
      <input type="file" id="yt_pic_inp" accept="image/*" style="display:none">
      <hr style="margin:12px 0;">
      <img src="${s.twPic}" class="profilepic"><br>
      <input class="inp" id="tw_name" value="${s.twName}" maxlength="18" placeholder="Twitch Name"><br>
      <label class="menu-btn" for="tw_pic_inp">Twitch Bild ändern</label>
      <input type="file" id="tw_pic_inp" accept="image/*" style="display:none">
      <hr style="margin:12px 0;">
      <div>Account-Code:<br><span id="code" style="font-size:1.3rem;">${s.code}</span></div>
      <input class="inp" id="code_inp" placeholder="Code zum Laden">
      <button class="menu-btn" id="load_code">Account laden</button>
      <div class="video-list" id="prof_vids">
        <b>Videos:</b>
        ${s.videos.map(v=>`<div class="video-item">${v.name} (${v.subs} Abos)</div>`).join('')}
      </div>
      <button class="menu-btn" id="back_main">Zurück</button>
    </div>
  `;
}
function twitchMenu(s){
  return `
    <div class="c sec">
      <img src="${s.twPic}" class="profilepic" style="border:3px solid var(--tw)">
      <div><b>${s.twName}</b></div>
      <div>Twitch-Clips: <span id="tclips">${s.tclips||0}</span></div>
      <div>Twitch-Streams: <span id="tvids">${s.tvideos?s.tvideos.length:0}</span></div>
      <div>Twitch-Abos: <span id="tabs">${s.tabs||0}</span></div>
      <button class="btn twbtn" id="twbtn"><img src="${s.twPic}" class="profilepic" style="width:60px;height:60px;margin-right:10px;">Twitch</button>
      <button class="menu-btn" id="back_main">Zurück</button>
    </div>
  `;
}
function showPlayBtns(s){
  let html='';
  s.playbtns=s.playbtns||[];
  PLAYBTN_REQS.forEach((req,i)=>{
    if(s.subs>=req && !s.playbtns.includes(req)){
      s.playbtns.push(req);
      setTimeout(()=>alert('Play Button erhalten!'),400);
    }
    if(s.playbtns.includes(req))
      html+=`<span class="playbtn">${["Silber","Gold","Diamant","Rubin","Saphir"][i]} Play-Button</span>`;
  });
  return html;
}
function render(s,menu){
  let app=document.getElementById("app");
  if(menu==="main") app.innerHTML=mainMenu(s);
  else if(menu==="cut") app.innerHTML=cutMenu(s);
  else if(menu==="shop") app.innerHTML=shopMenu(s);
  else if(menu==="profile") app.innerHTML=profileMenu(s);
  else if(menu==="upload") app.innerHTML=uploadMenu(s,s.lastCut||1);
  else if(menu==="twitch") app.innerHTML=twitchMenu(s);
  if(menu==="main") document.getElementById("playbtns").innerHTML=showPlayBtns(s);
}
function gameLoop(){
  let s=window.gamestate;
  let boost=1+(s.managerLvl||0)*0.05*(s.cutterLvl+s.klickerLvl+s.streamerLvl+1);
  let pboost=(s.playbtns||[]).length?1+0.3*(s.playbtns.length):1;
  // Klicker
  if(s.klickerLvl){let c=s.klickerLvl; s.clips+=Math.floor((c*boost*pboost)*0.5);}
  // Cutter
  if(s.cutterLvl && s.clips>=1 && !s.cutBusy){
    let time=Math.max(5000-400*s.cutterLvl,700);
    s.cutBusy=true;
    setTimeout(()=>{
      let cnt=Math.min(s.clips,s.cutterLvl+1);
      s.clips-=cnt;
      s.lastCut=cnt;
      s.cutBusy=false;
      render(s,"upload");
      saveGame(s);
    },time);
  }
  // Streamer
  if(s.streamerLvl && s.subs>=2000){
    let c=s.streamerLvl; s.tclips=(s.tclips||0)+Math.floor((c*boost*pboost)*0.5);}
  saveGame(s);
  setTimeout(gameLoop,1300);
}
function init(){
  let s=genProfile(null,{
    ytName:"Mein Kanal", ytPic:"https://i.imgur.com/sQyQG0C.png",
    twName:"Mein Twitch", twPic:"https://static-cdn.jtvnw.net/jtv_user_pictures/xarth/404_user_70x70.png",
    code:uniqCode(),clips:0,subs:0,videos:[],lastCut:1,
    cutterLvl:0,klickerLvl:0,managerLvl:0,streamerLvl:0,playbtns:[]
  });
  Object.assign(s,loadSave()||{});
  window.gamestate=s;
  let menu="main";
  render(s,menu);
  document.body.onclick=e=>{
    let t=e.target;
    let id=t.id;
    if(id==="ytbtn"){ s.clips++; render(s,"main"); saveGame(s);}
    if(id==="goto_cut"){ render(s,"cut");}
    if(id==="goto_shop"){ render(s,"shop");}
    if(id==="goto_profile"){ render(s,"profile");}
    if(id==="goto_twitch"){ render(s,"twitch");}
    if(id==="back_main"){ render(s,"main");}
    if(id==="cut_start"){
      let n=Math.max(1,Math.min(parseInt(document.getElementById("cut_num").value)||1,s.clips));
      s.cutBusy=true;
      let time=Math.max(3000-350*(s.cutterLvl||0),600)*n;
      document.getElementById("cutprog").innerText="Schneide...";
      setTimeout(()=>{
        s.clips-=n;s.lastCut=n;s.cutBusy=false;render(s,"upload");saveGame(s);
      },time);
    }
    if(id==="upload_vid"){
      let vn=document.getElementById("vid_name").value||`Video #${s.videos.length+1}`;
      let vs=Math.max(10,Math.floor(25+Math.random()*60)*(1+(s.managerLvl||0)*.1+(s.cutterLvl||0)*.2+(s.klickerLvl||0)*.1+(s.playbtns||[]).length*0.3));
      let rng=Math.random();
      if(rng<0.15)vs=-(Math.floor(Math.abs(vs/2))+1);
      s.videos.push({name:vn,subs:vs});
      s.subs+=vs;
      if(s.subs<0)s.subs=0;
      render(s,"main");saveGame(s);
    }
    // Shop
    if(id&&id.startsWith("buy_")){
      let k=id.split("_")[1];
      let base={cutter:200,klicker:150,streamer:450,manager:800}[k];
      let lvl=s[k+"Lvl"]||0;
      let price=expCost(base,lvl);
      if(s.clips>=price){
        s.clips-=price;
        s[k+"Lvl"]=(lvl+1);
        render(s,"shop");saveGame(s);
      }else alert("Nicht genug Clips!");
    }
    // Profil
    if(id==="yt_pic_inp"||id==="tw_pic_inp"){
      let isYT=id==="yt_pic_inp";
      t.onchange=ev=>{
        imgToData(ev.target.files[0],url=>{
          isYT?s.ytPic=url:s.twPic=url;
          render(s,"profile");saveGame(s);
        });
      }
    }
    if(id==="yt_name"){
      t.oninput=ev=>{s.ytName=t.value;saveGame(s);}
    }
    if(id==="tw_name"){
      t.oninput=ev=>{s.twName=t.value;saveGame(s);}
    }
    if(id==="load_code"){
      let cd=document.getElementById("code_inp").value.trim();
      if(!cd)return alert("Code eingeben!");
      let ext=localStorage.getItem("ytclicker_"+cd);
      if(!ext)return alert("Code nicht gefunden.");
      let d=JSON.parse(ext);
      Object.assign(s,d);
      saveGame(s);render(s,"main");
    }
    // Twitch
    if(id==="twbtn"){
      s.tclips=(s.tclips||0)+1;render(s,"twitch");saveGame(s);
      if(!s.tvideos)s.tvideos=[];
      if(s.tclips>=5){
        s.tclips-=5;
        let name="Stream #"+(s.tvideos.length+1);
        let subs=Math.floor(10+Math.random()*30+((s.streamerLvl||0)*3));
        s.tabs=(s.tabs||0)+subs;
        s.tvideos.push({name,subs});
        render(s,"twitch");saveGame(s);
      }
    }
  };
  // Input listeners
  document.body.oninput=e=>{
    let t=e.target;
    if(t.id==="yt_name"){ s.ytName=t.value;saveGame(s);}
    if(t.id==="tw_name"){ s.twName=t.value;saveGame(s);}
  };
  // File input listeners
  document.body.onchange=e=>{
    let t=e.target;
    if(t.id==="yt_pic_inp") imgToData(t.files[0],url=>{ s.ytPic=url;render(s,"profile");saveGame(s);});
    if(t.id==="tw_pic_inp") imgToData(t.files[0],url=>{ s.twPic=url;render(s,"profile");saveGame(s);});
  };
  // Save code to separate LS element for import
  setInterval(()=>{localStorage.setItem("ytclicker_"+s.code,JSON.stringify(s));},5000);
  gameLoop();
}
window.onload=init;
</script>
</body>
</html>
